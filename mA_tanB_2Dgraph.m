clear;clc;

[tanB,mA]=meshgrid(2:2:48,300:50:1000);

cross= [0.00021595108,0.00021423008,0.00021531153,0.00021574382,0.00021580766,0.00021533165,0.00021453205,0.00021559566,0.00021479523,0.00021511318,0.00021639929,0.00021587664,0.00021466284,0.00021586234,0.00021520841,0.00021383448,0.00021628141,0.00021605041,0.00021503128,0.0002149494,0.00021514321,0.00021508421,0.00021629121,0.00021526679,0.00021568073,0.00021493759,0.00021550212,0.00021430111,0.00021539975,0.00021508441,0.00021457286,0.00021559239,0.00021574401,0.00021530172,0.00021473138,0.00021534343,0.0002154244,0.00021463226,0.00021525956,0.00021546126,0.00021487076,0.00021599528,0.00021513984,0.0002155795,0.00021481333,0.00021620562,0.00021573286,0.00021539849,0.00021582655,0.00021552742,0.000215194,0.00021517215,0.00021667438,0.00021626996,0.00021608549,0.00021547418,0.00021704857,0.00021496667,0.00021494046,0.00021552169,0.00021638023,0.00021530529,0.00021521711,0.00021585163,0.00021540606,0.00021539458,0.00021537277,0.00021647519,0.00021633295,0.00021495653,0.00021545201,0.0002157274,0.00021541124,0.00021633367,0.00021518097,0.00021488293,0.00021487002,0.00021566905,0.00021443771,0.00021497643,0.00021648975,0.00021634223,0.00021571558,0.00021570024,0.00021594012,0.00021545136,0.00021596546,0.00021586811,0.00021530195,0.00021504138,0.00021558433,0.00021552413,0.00021597071,0.0002149422,0.00021473506,0.00021549103,0.00021673119,0.0002165587,0.00021591669,0.00021451029,0.00021616964,0.00021542035,0.00021670874,0.00021576678,0.00021627344,0.00021462325,0.00021554908,0.0002162647,0.00021556103,0.00021528745,0.00021544558,0.00021514871,0.00021637249,0.00021544135,0.00021548813,0.00021449731,0.00021599222,0.00021641381,0.0002157128,0.00021500736,0.00021535384,0.00021519707,0.00021546098,0.00021448181,0.00021580058,0.00021526187,0.00021596007,0.00021503153,0.00021637401,0.0002156035,0.00021502091,0.00021620526,0.00021552834,0.00021525197,0.00021501516,0.00021504775,0.00021490002,0.0002165565,0.0002145159,0.00021630514,0.00021612411,0.00021517136,0.00021606823,0.00021561955,0.00021554466,0.00021649946,0.00021664828,0.00021523926,0.00021608208,0.00021698758,0.00021461427,0.00021544737,0.00021624576,0.00021467583,0.00021686921,0.00021578777,0.00021637961,0.00021522123,0.00021481108,0.00021486015,0.00021578419,0.00021543953,0.00021570531,0.00021479594,0.00021622909,0.00021561505,0.00021609011,0.00021633973,0.00021637349,0.00021583865,0.00021519728,0.00021553315,0.00021515963,0.00021441989,0.00021585326,0.00021527354,0.00021470226,0.0002148359,0.00021558883,0.00021533188,0.00021562459,0.00021628373,0.0002156663,0.00021708625,0.00021541579,0.00021604932,0.0002159661,0.00021506387,0.00021634837,0.00021561354,0.00021523694,0.00021538261,0.00021524042,0.00021518172,0.00021586667,0.00021517753,0.0002152124,0.00021446625,0.00021560239,0.00021647885,0.00021478705,0.00021530581,0.00021582932,0.00021581637,0.00021671296,0.00021502408,0.00021640987,0.00021560232,0.00021524458,0.00021594018,0.00021512172,0.00021479554,0.00021512973,0.00021475907,0.00021533023,0.00021506172,0.00021550165,0.00021668211,0.00021718911,0.00021523554,0.00021468903,0.00021512787,0.00021574609,0.00021661923,0.00021506839,0.00021593348,0.00021431997,0.00021528111,0.00021456799,0.00021609675,0.00021625882,0.00021566869,0.00021550495,0.00021588611,0.00021558552,0.00021677547,0.00021571968,0.00021677387,0.00021483272,0.00021561793,0.000216244,0.00021501557,0.00021537973,0.00021636292,0.00021599059,0.00021561004,0.0002159534,0.00021449557,0.00021576452,0.00021542773,0.00021502639,0.00021451811,0.00021495206,0.00021669228,0.0002158834,0.00021514011,0.00021548281,0.00021433754,0.00021432016,0.00021577476,0.00021502673,0.00021521153,0.00021488153,0.00021471054,0.00021560838,0.00021665829,0.00021670733,0.00021623702,0.00021480904,0.00021492982,0.00021447143,0.00021582075,0.00021559696,0.00021508893,0.00021453782,0.00021352675,0.00021550862,0.00021537711,0.00021670976,0.00021536313,0.00021633365,0.00021528984,0.00021568353,0.00021608128,0.00021646504,0.00021646252,0.00021605116,0.00021532815,0.00021561793,0.0002139107,0.00021569299,0.00021592229,0.00021673641,0.00021551846,0.00021528528,0.0002152607,0.00021499177,0.00021567444,0.00021536611,0.00021545945,0.00021589906,0.00021666355,0.00021657241,0.00021566293,0.00021443159,0.00021397944,0.00021471709,0.00021644927,0.00021551151,0.00021525888,0.00021606427,0.00021540508,0.00021596852,0.00021491601,0.00021512369,0.00021484092,0.00021566687,0.00021591722,0.00021577143,0.0002150904,0.00021561209,0.00021561187,0.00021616273,0.00021554366,0.00021527843,0.00021615182,0.00021524237,0.00021510075,0.00021516198,0.00021579005,0.00021590545,0.00021530084,0.00021608498,0.00021518987,0.00021565224,0.00021596987,0.00021424972,0.00021588084,0.00021568075,0.00021592195,0.00021592575,0.00021499843,0.00021591281,0.00021392813,0.00021529239,0.00021497033,0.00021491411,0.00021584771,0.00021586852,0.00021541859,0.00021507824,0.00021522908,0.00021512107,0.00021589108,0.00021452397,0.00021689033,0.00021539893,0.00021525924,0.00021529323,0.00021599864,0.008911041,7.059141*10^-05,1.845529*10^-05,0.00061225439,4.8550344*10^-06,1.2649849*10^-06,0.008882432,0.00217886,0.0009654698,0.0005429117,0.0003459922,0.0002391154,0.00017708022,0.00013408822,0.0001059188,8.540856*10^-05,7.053197*10^-05,5.884243*10^-05,5.007691*10^-05,4.309748*10^-05,3.734839*10^-05,3.274057*10^-05,2.876134*10^-05,2.546261*10^-05,2.283452*10^-05,2.055982*10^-05,1.846536*10^-05,1.669169*10^-05,1.5220393*10^-05,1.3847106*10^-05,0.006515429,0.001581125,0.0007045472,0.0003914885,0.0002512144,0.00017474239,0.00012836675,9.754469*10^-05,7.68325*10^-05,6.219682*10^-05,5.136005*10^-05,4.266553*10^-05,3.645124*10^-05,3.149829*10^-05,2.700674*10^-05,2.371509*10^-05,2.0893114*10^-05,1.8549009*10^-05,1.6572624*10^-05,1.477311*10^-05,1.3270184*10^-05,1.2087953*10^-05,1.1001753*10^-05,1.0058251*10^-05,0.004767596,0.0011706499,0.0005133821,0.0002887732,0.00018512062,0.00012853058,9.426244*10^-05,7.191046*10^-05,5.657648*10^-05,4.593288*10^-05,3.761162*10^-05,3.144868*10^-05,2.677217*10^-05,2.2932849*10^-05,1.9926151*10^-05,1.7422091*10^-05,1.5310429*10^-05,1.3708449*10^-05,1.2149998*10^-05,1.0963781*10^-05,9.912803*10^-06,8.908181*10^-06,8.090599*10^-06,7.39651*10^-06,0.003553139,0.0008708356,0.0003843594,0.00021685674,0.00013808171,9.566428*10^-05,7.042367*10^-05,5.371444*10^-05,4.215272*10^-05,3.399547*10^-05,2.8204096*10^-05,2.3629085*10^-05,2.0015082*10^-05,1.7247948*10^-05,1.4917842*10^-05,1.2996537*10^-05,1.1484771*10^-05,1.0165444*10^-05,9.125706*10^-06,8.141506*10^-06,7.317281*10^-06,6.647149*10^-06,6.075261*10^-06,5.522035*10^-06,0.0026992986,0.0006617332,0.00029141114,0.00016382008,0.00010456439,7.224544*10^-05,5.334697*10^-05,4.076852*10^-05,3.2082808*10^-05,2.5760667*10^-05,2.1333054*10^-05,1.7849043*10^-05,1.5169133*10^-05,1.3022135*10^-05,1.1283472*10^-05,9.830836*10^-06,8.675973*10^-06,7.701113*10^-06,6.885839*10^-06,6.160946*10^-06,5.578076*10^-06,5.03769*10^-06,4.583218*10^-06,4.181211*10^-06,0.0020518802,0.0005065137,0.00022370152,0.00012481358,7.988184*10^-05,5.532038*10^-05,4.075344*10^-05,3.0979099*10^-05,2.4548879*10^-05,1.9678598*10^-05,1.6247015*10^-05,1.3693927*10^-05,1.1508196*10^-05,9.909346*10^-06,8.624124*10^-06,7.528536*10^-06,6.625941*10^-06,5.876896*10^-06,5.256973*10^-06,4.703983*10^-06,4.246114*10^-06,3.8519401*10^-06,3.4899604*10^-06,3.1941225*10^-06,0.001590075,0.00039091999,0.0001733346,9.686658*10^-05,6.177987*10^-05,4.2696048*10^-05,3.1385396*10^-05,2.4048635*10^-05,1.8823496*10^-05,1.5209302*10^-05,1.2560755*10^-05,1.0544138*10^-05,8.952559*10^-06,7.704988*10^-06,6.66515*10^-06,5.835992*10^-06,5.144349*10^-06,4.555065*10^-06,4.0772985*10^-06,3.6524099*10^-06,3.3062076*10^-06,2.9755619*10^-06,2.7020234*10^-06,2.4540802*10^-06,0.0012360304,0.00030366196,0.00013398041,7.531576*10^-05,4.8052659*10^-05,3.3377175*10^-05,2.4373505*10^-05,1.8648514*10^-05,1.4767768*10^-05,1.1906993*10^-05,9.823789*10^-06,8.217005*10^-06,6.961*10^-06,5.992368*10^-06,5.197864*10^-06,4.5495501*10^-06,4.0153499*10^-06,3.5318898*10^-06,3.1494304*10^-06,2.838994*10^-06,2.5763213*10^-06,2.3204479*10^-06,2.1109645*10^-06,1.92507*10^-06,0.0009676784,0.00023661213,0.00010511123,5.933328*10^-05,3.7478578*10^-05,2.6111304*10^-05,1.9207581*10^-05,1.4640799*10^-05,1.1588766*10^-05,9.312928*10^-06,7.700115*10^-06,6.43903*10^-06,5.4578898*10^-06,4.6815764*10^-06,4.083945*10^-06,3.5597484*10^-06,3.124407*10^-06,2.7745052*10^-06,2.4904127*10^-06,2.2332158*10^-06,2.0119794*10^-06,1.8181287*10^-06,1.6589314*10^-06,1.5087299*10^-06,0.0007694954,0.00018853258,8.317253*10^-05,4.6665807*10^-05,2.9763023*10^-05,2.0717789*10^-05,1.5225475*10^-05,1.1601771*10^-05,9.139321*10^-06,7.389093*10^-06,6.0740734*10^-06,5.0822064*10^-06,4.3102282*10^-06,3.7088886*10^-06,3.2221396*10^-06,2.8227432*10^-06,2.4732004*10^-06,2.2050436*10^-06,1.965151*10^-06,1.7615811*10^-06,1.5862006*10^-06,1.4429274*10^-06,1.3099332*10^-06,1.1934655*10^-06,0.00061260701,0.0001489957,6.6210814*10^-05,3.7056805*10^-05,2.3718126*10^-05,1.6434123*10^-05,1.202395*10^-05,9.219421*10^-06,7.278958*10^-06,5.8920307*10^-06,4.8536483*10^-06,4.0460893*10^-06,3.439693*10^-06,2.9711651*10^-06,2.5632387*10^-06,2.2449388*10^-06,1.970618*10^-06,1.7554226*10^-06,1.559597*10^-06,1.4014582*10^-06,1.2637942*10^-06,1.1428943*10^-06,1.0354385*10^-06,9.496033*10^-07,0.00048958568,0.00011988658,5.2988453*10^-05,2.9722989*10^-05,1.9100768*10^-05,1.3188553*10^-05,9.653329*10^-06,7.389329*10^-06,5.8000728*10^-06,4.70287*10^-06,3.875451*10^-06,3.2288818*10^-06,2.7399206*10^-06,2.3607806*10^-06,2.0499548*10^-06,1.7920511*10^-06,1.56945*10^-06,1.3977212*10^-06,1.2435584*10^-06,1.1167685*10^-06,1.014653*10^-06,9.200212*10^-07,8.346476*10^-07,7.6006132*10^-07,0.00039134821,9.676973*10^-05,4.2507171*10^-05,2.392147*10^-05,1.528164*10^-05,1.0609745*10^-05,7.7648838*10^-06,5.9263408*10^-06,4.6779425*10^-06,3.7797073*10^-06,3.116447*10^-06,2.5999638*10^-06,2.2138675*10^-06,1.8906659*10^-06,1.6498871*10^-06,1.4415455*10^-06,1.2610497*10^-06,1.1237797*10^-06,1.0066162*10^-06,9.017128*10^-07,8.1182897*10^-07,7.3677243*10^-07,6.6981327*10^-07,6.1121494*10^-07,0.00031838106,7.7832349*10^-05,3.4374341*10^-05,1.9392505*10^-05,1.2319702*10^-05,8.5431493*10^-06,6.2817324*10^-06,4.7930653*10^-06,3.7928598*10^-06,3.0430806*10^-06,2.5142058*10^-06,2.1204976*10^-06,1.78136*10^-06,1.5375919*10^-06,1.3317388*10^-06,1.1573132*10^-06,1.03211*10^-06,9.1114442*10^-07,8.1535452*10^-07,7.256864*10^-07,6.5507534*10^-07,5.9653361*10^-07,5.4202282*10^-07,4.9436697*10^-07,0.00025873959,6.3004735*10^-05,2.8042635*10^-05,1.5669008*10^-05,1.00273726*10^-05,6.9811042*10^-06,5.1275212*10^-06,3.881239*10^-06,3.0669835*10^-06,2.4740095*10^-06,2.0526867*10^-06,1.7087249*10^-06,1.4459419*10^-06,1.251033*10^-06,1.0785869*10^-06,9.4721037*10^-07,8.3801742*10^-07,7.427014*10^-07,6.5801743*10^-07,5.930985*10^-07,5.3317442*10^-07,4.8344058*10^-07,4.3879249*10^-07,4.0333256*10^-07];
cross = cross(1,367:726);
cross = vec2mat(cross,24) *1000;

cross2= [0.010961983,0.009921407,0.008909626,0.008096903,0.007350627,0.006698762,0.006125551,0.005649124,0.005211079,0.004820316,0.004500596,0.004191896,0.003888345,0.009331156,0.008343953,0.007540538,0.006899416,0.006248476,0.005707922,0.005223214,0.004798619,0.004417251,0.004135858,0.003811434,0.003553489,0.003320382,0.007945781,0.007174698,0.006455789,0.005836751,0.005318696,0.004862085,0.004442994,0.004097357,0.003778553,0.003506595,0.00325015,0.003023972,0.002822649,0.006821173,0.006083062,0.005555444,0.005005914,0.004562144,0.004155824,0.003830192,0.003510902,0.003247046,0.003012523,0.002789159,0.00260844,0.00242748,0.005884816,0.005339398,0.004782477,0.004309609,0.003942178,0.003569461,0.003276432,0.003015353,0.002798637,0.002586655,0.0023993079,0.0022325608,0.0020869915,0.00507037,0.004513177,0.004136186,0.00374214,0.003371403,0.003088292,0.002834183,0.0026203484,0.0024225758,0.0022325869,0.0020578649,0.0019262234,0.0018018212,0.004350135,0.003973178,0.003578973,0.003221913,0.0029198098,0.0026716924,0.0024534139,0.0022487783,0.002086541,0.0019294605,0.0017916394,0.0016676243,0.0015573985,0.00380484,0.003464311,0.0030883374,0.0027938381,0.0025404559,0.0023302547,0.002136903,0.0019613343,0.0018048069,0.0016827416,0.0015600794,0.0014569608,0.0013521261,0.0033267938,0.002995505,0.0026993073,0.0024427197,0.0022254534,0.0020285899,0.0018608971,0.0017080805,0.0015786526,0.0014643692,0.0013575632,0.0012581675,0.0011805175,0.0028962627,0.0026195971,0.0023405525,0.0021222875,0.0019351465,0.001765227,0.0016175517,0.0014890285,0.0013763028,0.001274328,0.0011860591,0.0011047193,0.0010335502,0.0025338307,0.0023039422,0.002061456,0.0018653316,0.0016982537,0.0015537323,0.0014139215,0.0013066105,0.001201223,0.001120488,0.0010376278,0.0009644315,0.0008995697,0.0022229811,0.0020142961,0.0018102572,0.0016393595,0.0014890212,0.0013555028,0.0012501553,0.0011410046,0.0010538477,0.0009860364,0.000907316,0.0008485823,0.0007950849,0.0019557004,0.0017749899,0.0015906931,0.0014356448,0.0013097683,0.0011964776,0.00109713,0.0010062052,0.0009330673,0.0008613147,0.0008006925,0.0007476443,0.0006956259,0.0017306372,0.0015647977,0.0014036335,0.0012700406,0.001148226,0.0010507847,0.0009670077,0.000886213,0.000816207,0.0007593311,0.0007034282,0.000657713,0.0006151065,0.0015237165,0.0013873233,0.0012456241,0.0011203821,0.001023114,0.0009314307,0.0008530331,0.0007874648,0.0007257656,0.0006718552,0.0006227194,0.000579998,0.0005438279,0.0013525788,0.0012213746,0.0010962919,0.0009914282,0.0009052959,0.0008200901,0.0007536019,0.0006947717,0.0006431593,0.0005967458,0.0005508347,0.00051522946,0.00048022199,0.0011997878,0.001083283,0.0009703533,0.0008795115,0.000801432,0.0007291635,0.0006711683,0.000614509,0.0005684336,0.00053224597,0.00048938022,0.0004558934,0.00042699229];
cross2 = vec2mat(cross2,13) *1000;

[tanB2,mA2]= meshgrid(1.8:0.1:3,300:25:700);

sigma_exp1 = 6.5156; % = 1.7 * sigma_SM - sigma_SM lower limit
sigma_exp2 = 15.8235, % = 2.7 * sigma_SM - sigma_SM expected value

scr_info = get(groot,'ScreenSize');
figure(1)
fig1 = figure(1);
set(fig1, 'Position', [0 scr_info(4)/2 scr_info(3)/2 scr_info(4)/2]);

hold on
[C1,h1] = contourf(tanB,mA,cross,'LevelList',[5 1 0.1 0.01 0.001 0.0001]);
[C3,h3] = contour(tanB,mA,cross,'LevelList',[0 sigma_exp1],'edgeColor','g','lineWidth',2,'lineStyle','--');
hold off


xlabel('tan(\beta)')
ylabel('mA    (GeV)')
clabel(C1,h1,'labelspacing',700)
clabel(C3,h3,'labelspacing',700)
colormap(fig1,cool)
colorbar('EastOutside')
title('Cross section for pp>tth3 process at 13Tev in (fb)')
axis([2 48 300 1000])


figure(2)
fig2 = figure(2);
set(fig2, 'Position', [0 scr_info(4)/2 scr_info(3)/2 scr_info(4)/2]);

[C2,h2] = contourf(tanB2,mA2,cross2,'LevelList',[20 10 9 8 7 6 5 4 3 2 1 0.1 0.01]);

xlabel('tan(\beta)')
ylabel('mA    (GeV)')
clabel(C2,h2,'labelspacing',700)
colormap(fig2,cool)
colorbar('EastOutside')
title('Cross section for pp>tth3 process at 13Tev in (fb)')
axis([1.8 3 300 700])